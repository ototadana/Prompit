Prompit 1.1
===========

手動テストのサポート
--------------------
Markdown 形式で記述したシナリオを見ながらテストが実行できる

### シナリオ表示およびテスト結果表示機能
画面上に表示されたテストシナリオを見ながら手動テスト操作を行うことでテスト漏れを防止したい

1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダを作成する
    2.  上記のフォルダに `test-01.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            リリース名
            ==========

            フィーチャー
            ------------
            フィーチャー説明

            ### シナリオ
            シナリオ詳細

            1.  ステップ1
            1.  ステップ2
            1.  ステップ3

    3.  (すでに存在する場合、)`C:\Users\[ユーザー名]\Documents\Prompit\TestResults\`
        の下の `test-01` フォルダおよび `test-01.xml` ファイルを削除する

1.  アプリを起動するとシナリオファイル選択画面が開き、ファイル選択できること [*]

1.   `test-01.md` ファイルを選択すると以下の状態で画面表示される [*]
    *   「リリース名 - フィーチャー」がタイトルバーに
    *   画面上部に「シナリオ」と「1/3」というシナリオ内ステップ表示ラベル
    *   「シナリオ」上にマウスを移動するとシナリオ詳細がバルーンチップ表示されること
    *   「001. ステップ1」の形式で最初にステップ番号が表示されること
    *   コメント入力欄に「まだテストされていません」と表示されていること
    *   「戻る」ボタンと「次へ」ボタン
    *   「戻る」ボタンは非活性になっていること
    *   プログレスバー (0%)、「0%」というステップ表示ラベル、「スクリーンショット」、「リロード」ボタン
    *   コメント入力欄、スクリーンショット、リロードボタンはツールチップ表示されること

1.  コメント欄のテキストを削除して、「次へ」をクリックすると、「002. ステップ2」が表示されること [*]
    *   「次へ」をクリックすると処理中はマウスカーソルが砂時計になること
    *   「002. ステップ2」表示の際には
        *   前のステップ表示の時よりもプログレスバーが長くなること
        *   プログレスバーの色は緑色であること
        *   「33%」というラベル表示がされていること
        *   「戻る」も「次へ」もどちらも活性状態になっていること

1.  コメント欄に「aaa」と入力して「次へ」をクリックすると、「003. ステップ3」が表示されること [*]
    *   「003. ステップ3」では以下の内容が表示される
        *   「002. ステップ2」表示の時よりもプログレスバーが長くなること
        *   プログレスバーの色は赤色であること

1.  「戻る」をクリックすると「002. ステップ2」が表示され、コメント欄に「aaa」が表示されていること [*]
    *   「戻る」をクリックすると処理中はマウスカーソルが砂時計になること

1.  コメント欄を「あああ」に書き換えて「次へ」をクリックすると、「003. ステップ3」が表示されること [*]

1.  そのまま「次へ」をクリックすると、終了画面が表示される [*]
    終了画面では以下の表示になる
    *   「次へ」と「スクリーンショット」ボタンは非活性になっていること
    *   「リロード」ボタンの代わりに「終了」ボタンが表示されていること
    *   終了ボタンはツールチップ表示されること
    *   テスト件数(3)、エラー件数(0)、失敗件数(2)、所要時間が表示されていること
    *   テスト結果ファイルがリンクとして表示されていること
    *   リンクの上にマウスカーソルを移動すると、ファイルパスがツールチップ表示されること

1.  テスト結果ファイル名をクリックするとそのファイルが開くこと [*]

1.  「終了」ボタンをクリックするとアプリが終了すること

### シナリオ内ステップ表示
同一シナリオ内で今どこまでテストが進捗しているかを把握したい

1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダに
        `test-01-a.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            ### シナリオ1

            1.  ステップ1
            1.  ステップ2
            1.  ステップ3

            ### シナリオ2

            1.  ステップ1
            1.  ステップ2

            ### シナリオ3

            1.  ステップ1

    1.  (すでに存在する場合、)`C:\Users\[ユーザー名]\Documents\Prompit\TestResults\`
        の下の `test-01-a` フォルダおよび `test-01-a.xml` ファイルを削除する

1.   `test-01-a.md` ファイルを選択すると以下の状態で画面表示されること
    *   画面上部右端に「1/3」というシナリオ内ステップ表示ラベル

1.  「次へ」をクリックすると、シナリオ内ステップ表示ラベルが「2/3」になること
1.  「次へ」をクリックすると、シナリオ内ステップ表示ラベルが「3/3」になること
1.  「戻る」をクリックすると、シナリオ内ステップ表示ラベルが「2/3」になること
1.  「次へ」をクリックすると、シナリオ内ステップ表示ラベルが「3/3」になること
1.  「次へ」をクリックすると、画面上部に「シナリオ2」が表示され、
    シナリオ内ステップ表示ラベルが「1/2」になること
1.  「次へ」をクリックすると、シナリオ内ステップ表示ラベルが「2/2」になること
1.  「次へ」をクリックすると、画面上部に「シナリオ3」が表示され、
    シナリオ内ステップ表示ラベルが「1/1」になること
1.  「次へ」をクリックすると、画面上部に「テスト結果」が表示され、
    シナリオ内ステップ表示ラベルが非表示になること
1.  「戻る」をクリックすると、画面上部に「シナリオ3」が表示され、
    シナリオ内ステップ表示ラベルが「1/1」になること



### 画面操作性向上
画面操作の操作性を向上するための機能がほしい

1.  (事前準備) `Prompit.exe` を起動し、`test-01.md` ファイルを選択する
1.  ウインドウは以下の状態になっていること
    *   コメント欄の上部にマウスカーソルを移動すると、境界線の色が強調され、カーソルの形状が変わること
    *   そのままコメント欄の上部をドラッグすると、行幅を変更することができること
    *   別のウインドウをクリックしたときにも前面表示されていること
    *   コメント入力欄にフォーカスが移るとテキストが自動的に全選択されること
    *   コメント入力欄上にフォーカスがある状態ででタブキーを押すと「次へ」ボタンにフォーカスが移ること
1.  コメント欄に文字列がない場合、左右矢印キーで「戻る」、「次へ」の操作ができること
1.  「次へ」をクリックして表示した画面でコメント入力欄に文字列がある場合、自動的にコメント欄にフォーカスが移っていること
1.  Ctrl キーを押すと、ボタン表示が変わること
1.  Ctrl キーを押しながら「次へ」をクリックすると、直後の失敗Stepに移動すること
1.  Ctrl キーを押しながら「戻る」をクリックすると、直前の失敗Stepに移動すること
1.  Shift キーを押すと、ボタン表示が変わること
1.  Shift キーを押しながら「次へ」をクリックすると、最後のStepに移動すること
1.  Shift キーを押しながら「戻る」をクリックすると、先頭のStepに移動すること
1.  コメント欄に文字列があっても、Alt キーを押しながら右矢印キーを押すと、次のStepに移動すること
1.  コメント欄に文字列があっても、Alt キーを押しながら左矢印キーを押すと、前のStepに移動すること
1.  別のウインドウをアクティブにして、再度このウインドウをクリックしてアクティブにすると、
    コメント入力欄に自動的にフォーカスが移動すること

### チェックボックス
一つのステップで複数の確認項目がある場合、チェックボックスとして表示される


1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダに
        `test-02.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            ### シナリオ
            1.  ステップ1
                *   確認項目1
                *   確認項目2
                *   確認項目3

    1.  (すでに存在する場合、)`C:\Users\[ユーザー名]\Documents\Prompit\TestResults\`
        の下の `test-02` フォルダおよび `test-02.xml` ファイルを削除する
    1.  `Prompit.exe` を起動し、`test-02.md` を読み込む
1.  リスト項目がある場合、チェックボックス付きで表示されること [*]
1.  「確認項目1」のチェックボックスをクリックすると、
    コメント欄の「まだテストされていません」が消去されること
1.  チェック状態はそのステップから移動しても保持されることを以下の手順で確認する
    1.  「確認項目1」だけにチェックを付けた状態で「次へ」をクリックし次のステップに移動する
    1.  「戻る」をクリックして最初のステップに戻ると以下の状態となっている
        *   「確認項目1」にはチェックがついている
        *   「確認項目2」と「確認項目3」にはチェックがついていない
1.  チェック状態はHTMLレポートに反映されること [*]
1.  全てのチェックボックスがチェックされておらず、かつ、コメントがない場合、
    自動的にエラーコメントが挿入され、失敗状態となること [*]


### リンク
リンク表示がある場合、ブラウザでリンク先にジャンプできる

1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダに
        `test-03.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            ### シナリオ
            1.  ステップ1

                <http://www.google.com/>

    1.  (すでに存在する場合、)`C:\Users\[ユーザー名]\Documents\Prompit\TestResults\`
        の下の `test-03` フォルダおよび `test-03.xml` ファイルを削除する
    1.  `Prompit.exe` を起動し、`test-03.md` を読み込む
1.  `http://www.google.com/` がリンクとして表示され、
    クリックするとブラウザが開いてリンク先ページを表示できること [*]


### リロード機能
テスト実行中にシナリオファイルの編集を行った場合、即座にその変更を画面上に反映させたい

1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダに
        `test-04.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            ### シナリオ
            1.  ステップ1 [*]
                *   確認項目1
                *   確認項目2
            1.  ステップ2 [*]
                *   確認項目1
                *   確認項目2
            1.  ステップ3 [*]
                *   確認項目1
                *   確認項目2

    1.  (すでに存在する場合、)`C:\Users\[ユーザー名]\Documents\Prompit\TestResults\`
        の下の `test-04` フォルダおよび `test-04.xml` ファイルを削除する
    1.  `Prompit.exe` を起動し、`test-04.md` を読み込む

1.  以下の操作を行い、リロード機能を確認する
    1.  ステップ1で「確認項目1」をチェックし「次へ」
    1.  ステップ2でも「確認項目1」をチェックし「次へ」
    1.  ステップ3も「確認項目1」をチェックし「次へ」
    1.  リンクをクリックして HTML を開く
    1.  開いたHTMLで以下の状態になっていることを確認する
        *   ステップ1,2,3 全て「確認項目1」のみがチェックされていること
        *   ステップ1,2,3 全て画像が表示されること
    1.  「戻る」をクリックする
    1.  テキストエディタで「ステップ3」を「ステップ03」に変更し、
        「リロード」する
    1.  画面が以下の状態となっていることを確認する
        *   「ステップ03」と表示されていること
        *   確認項目1のチェックが外れていること
    1.  ブラウザ上でHTMLを再読み込みし、以下の状態になっていることを確認する
        *   ステップ1,2 は「確認項目1」のみがチェックされているが
            ステップ3は全てのチェックが外れていること
        *   ステップ1,2 は画像が存在するが、
            ステップ3には画像が存在しないこと


### レジューム機能
最後のステップまで実行しなかった場合、中断したステップから再実行できるようにする

1.  以下の手順で、ウインドウを閉じたステップから再開ができることを確認する
    1.  「リロード機能」のテストをひと通り行い、そのままウインドウを閉じる
    1.  再度 Prompit.exe を起動し、`test-04.md` を読み込む
    1.  画面が以下の状態となっていることを確認する
        *   「ステップ03」と表示されていること
        *   確認項目1、確認項目2のチェックが外れていること
    1.  ブラウザ上でHTMLを再読み込みし、以下の状態になっていることを確認する
        *   ステップ1,2 は「確認項目1」のみがチェックされているが
            ステップ3は全てのチェックが外れていること
        *   ステップ1,2 は画像が存在するが、
            ステップ3には画像が存在しないこと

1.  最後のステップまで実行した場合、次のテストは最初のステップからになることを
    以下の手順で確認する
    1.  「次へ」をクリックし、ウインドウを閉じる
    1.  Prompit.exe を起動し、`test-04.md` を読み込む
    1.  画面が以下の状態となっていることを確認する
        *   「ステップ1」と表示されていること
        *   すべてのチェックが外れていること
    1.  ブラウザ上でHTMLを再読み込みし、以下の状態になっていることを確認する
        *   ステップ1,2,3 全てにおいて全てのチェックが外れていること
        *   ステップ1,2,3 全てにおいて画像が存在しないこと


### ウインドウ、フォルダ状態の保存
終了時のウインドウ状態および、前回のシナリオファイル読み込みフォルダを保存すること

1.  事前準備として以下を実行する
    1.  `C:\Users\[ユーザー名]\AppData\Local\XPFriend_Community`
        の配下のフォルダを削除するか、`Settings.Default.Reset()` を呼び出して設定をクリアする
1.  `Prompit.exe` を起動すると、「ドキュメント」フォルダが初期表示されること [*]
1.  フォルダ移動を行い、任意のシナリオファイル選択すると、画面右上にウインドウが表示されること [*]
1.  ウインドウの位置を右下に移動してアプリを終了し、再度起動した場合、以下の状態となること [*]
    *   ファイル選択画面には前回指定したフォルダが初期表示されていること
    *   前回終了時の場所（右下）にウインドウが表示されること


### エラー処理機能
エラー発生時にエラー原因の追求ができるようにしてほしい

1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダを作成する
    2.  上記のフォルダに `test-05.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            リリース名
            ==========

1.  `Prompit.exe` を起動し、`test-05.md` を読み込むと「ファイルフォーマットが不正です」
    というメッセージが表示されること [*]
1.  「OK」をクリックするとアプリケーションが終了すること
1.  以下の操作を行い、想定外のエラーが発生した場合の動作を確認する
    1.  `Prompit.exe` を起動し、`test-01.md` を読み込む
    1.  エクスプローラーを使い、`C:\Users\[ユーザー名]\AppData\Local\XPFriend_Community` 
        の配下にある `user.config` ファイルを「読み取り専用」として設定する
    1.  「次へ」をクリックするとウインドウ上に例外エラー表示が行われるので以下を確認する [*]
        *   ウインドウ上にエラーメッセージが表示されること
        *   戻る、次へ等のボタン、プログレスバー、コメント欄は非表示になり、OKボタンのみが
            表示されること
        *   エラーメッセージ上にマウスカーソルを移動すると指マークとなること
        *   エラーメッセージをクリックするとログファイルが開くこと
        *   OKボタンをクリックすると元の画面が表示されること


テスト結果出力
--------------
テスト結果は JUnit 形式の XML と HTML で記録できる

### テスト結果のHTMLファイル出力
テスト結果は、後で人が参照できるようにするために HTML 形式でファイル出力してほしい

1.  事前準備として、以下を実施する
    1.  `C:\Users\[ユーザー名]\Documents\Prompit` フォルダに
        `test-06.md` というファイルを以下の内容で UTF-8 エンコーディングで作成する

            リリース名
            ==========

            フィーチャー
            ------------
            フィーチャー説明

            ### シナリオ
            シナリオ説明

            1.  ステップ1
                *   確認項目
            1.  ステップ2 [*]
                *   確認項目

    1.  `Prompit.exe` を起動して `test-06.md` を読み込み、以下の操作を行う
        1.  ステップ1 は確認項目をチェックし、コメント欄をクリアして「次へ」
        1.  ステップ2 はそのまま「次へ」
1.  「結果レポート」をクリックしてHTMLを表示し、以下の内容を確認する [*]
    *   以下の内容が記載されていること
        *   リリース名
        *   フィーチャーとフィーチャー説明
        *   シナリオとシナリオ説明
        *   ステップ1,2 のテスト結果
        *   ステップ1,2 の経過時間
    *   テスト結果の背景色は以下の通りであること
        *   テスト結果が正常な「ステップ1」は、白色で表示される
        *   テスト結果がエラーの「ステップ2」は、赤系色で表示される
    *   ステップごとのテスト結果の表示方法は以下の通りであること
        *   テスト結果が正常な「ステップ1」は、最初の行のみが表示される
        *   テスト結果がエラーの「ステップ2」は、エラーメッセージ等の詳細データが表示される
    *   「001. ステップ1」、「002. ステップ2」の部分はリンクとして表示されており、
        それをクリックすると詳細データの表示・非表示を切り替えることができること
    *   スクリーンショットがある「ステップ2」には、カメラアイコンが表示されていること
    *   スクリーンショットがある「ステップ2」は、詳細データ表示時に画像表示されること
    *   「リリース名」をクリックすると、以下の状態を切り替えられること
        *   全ての詳細データを折りたたみ、表示しない
        *   全ての詳細データを展開し、表示する
        *   エラー行のみ詳細データを表示する
1.  リリース行（先頭行）の色は、エラーがある場合は赤系、エラーがなければ青系とする
    エラーがない状態は以下の操作により確認する [*]
    1.  「戻る」ボタンで一つ戻る
    1.  「確認項目」をチェックし、コメント欄をクリアするして、「次へ」
    1.  ブラウザを再読み込みして、最新の HTML を表示する

### スクリーンショット機能
画面の状態や検証結果の妥当性を後から参照できるようにするため、スクリーンショットを取得する機能がほしい

1.  スクリーンショットボタンをクリックする、もしくは、ステップ記述内に `[*]`
    が書かれている場合、スクリーンショットが取得できることを以下の操作により確認する
    1.  `Prompit.exe` を起動して `test-06.md` を読み込む
    1.  もし、ステップ2が表示されて入れば、「戻る」でステップ1を表示し、以下を確認する
        *   マウスカーソルをスクリーンショットボタン上に移動すると、アイコンの色が変わり、
            クリック可能であることが理解できること
    1.  「次へ」をクリックしてステップ2を表示し、以下を確認する
        *   スクリーンショットボタンのまわりに枠が書かれていること
        *   マウスカーソルをスクリーンショットボタン上に移動しても、アイコンの色が変わらず、
            クリックしても何も起こらないこと
    1.  「次へ」をクリックして「結果レポート」クリックし、HTML をブラウザ上に表示して
        以下を確認する
        *   ステップ1では画像が表示されていないことを確認する
        *   ステップ2では（自動取得により）画像が表示されていることを確認する
    1.  「戻る」ボタンを二回クリックしてステップ1を表示し、スクリーンショットボタン
        をクリックする
        *   スクリーンショット取得時には、マウスカーソルが砂時計になること
        *   スクリーンショット取得時には、Prompit 以外の別のウインドウが
            自動的にアクティブなること
    1.  ブラウザをリロードして、HTMLファイルを最新化し、以下を確認する
        *   ステップ1で画像が表示されていること



### テスト結果のXMLファイル出力
テスト結果は、後でシステム上で有効活用できるようにするためにXML形式でファイル出力してほしい

1.  `Prompit.exe` を起動して `test-06.md` を読み込み、以下の操作を行う
    1.  ステップ1 は確認項目をチェックし、コメント欄をクリアして「次へ」
    1.  ステップ2 は確認項目のチェックを外し、「次へ」
    1.  `test-06.md` の格納されているフォルダの下の `TestResults` に
        `test-06.xml` ファイルが作成されているため、テキストエディタで開いて以下を確認する
        *   `<testsuite ...` は `tests="2" failures="1"` となっていること
        *   `<testcase name="001. ステップ1" ...` には `<failure>` 要素がないこと
        *   `<testcase name="002. ステップ2 [*]" ...` には `<failure>` 要素があり、
            `message` 属性が設定されていること
        *   `<testsuite ...`、`<testcase name="001. ステップ1" ...` 、
            `<testcase name="002. ステップ2 [*]" ...` のいずれにも `time` 属性が
            記述されていること


### 随時ファイル出力
不慮の状況に備えて、途中でテストが異常終了してもその直前のステップまでは記録しておいてほしい

1.  以下の手順でテスト中に強制終了を行い、結果ファイル出力を確認する
    1.  (すでに存在する場合、)`C:\Users\[ユーザー名]\Documents\Prompit\TestResults\`
        の下の `test-04` フォルダおよび `test-04.xml` ファイルを削除する
    1.  `Prompit.exe` を起動し、`test-04.md` ファイルを選択する
    1.  全ての確認項目にチェックを行い、コメント欄をクリアして、「次へ」
    1.  タスクマネージャーでアプリを強制終了する
    1.  以下の内容のファイルが出力されていることを確認する
        *   `test-04.xml`
            *   ステップ1のみが failure がなく、
                ステップ2, 3 は failure （まだテストされていません）があること
        *   `test-04\index.html`
            *   ステップ1のみが failure がなく、
                ステップ2, 3 は failure （まだテストされていません）があること
            *   ステップ1のみに画像ファイルがあり、
                ステップ2, 3 には画像ファイルがないこと



Jenkins との連携
----------------
手動テスト結果を Jenkins のテストレポートとして参照できる

### Jenkinsからの呼び出し
Prompit を Jenkins ジョブから起動できるようにしたい

1.  （事前準備）Jenkinsで以下のような設定を行う
    1.  Windows 環境で動作する GUI アプリを Jenkins から起動できるようにするために、
        Windows 用スレーブを作成し、以下のようなコマンドで起動する

            java -jar slave.jar -jnlpUrl http://localhost:8080/computer/[スレーブ名]/slave-agent.jnlp

    1.  Jenkins に [HTML Publisher Plugin](https://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin) 
        をインストールする

    1.  以下のようなジョブを作成する
        1.  「実行するノードを制限」にチェックを入れ、Windows スレーブの名前を入力する。
        2.  作成したテストシナリオファイルをチェックアウトできるように「ソースコード管理」の設定を行う。
        3.  「ビルド」に「Windowsバッチコマンドの実行」を追加して、「コマンド」欄に以下のような記述を行う。

                C:\Apps\Prompit\Prompit.exe test-01.md

        4.  「ビルド後の処理」に「JUnitテスト結果の集計」を追加し、
            「テスト結果XML」に `TestResults/*.xml` と入力する。
        5.  「ビルド後の処理」に「Publish HTML reports」を追加し、
            「TestResults/test-01」を「HTML directory to archive」欄に入力する。

1.  ビルド実行をし、以下を確認する
    *   Prompit が起動し、test-01.md が読み込まれ、ステップ1が表示されること
    *   テスト実施後、テスト結果を Jenkins 上で確認できること
    *   テスト実施後、HTML 版のテスト結果を画面左のリンクから参照できること


ドキュメンテーション
--------------------
ドキュメントを参照することにより利用方法が理解できる

### README
このソフトウェアの用途および利用方法を短時間で理解したい

1.  README.md には英語で以下の記述がされていること
    *   利用目的
    *   フィーチャー
    *   必須ソフトウェア
    *   ダウンロードURL
    *   利用方法
    *   このソフトウェアのライセンス
    *   このソフトウェアが利用しているソフトウェアとそれぞれのライセンス
1.  README.md 上に存在する URL が全て有効であること
1.  README.ja.md に日本語版ドキュメントが記載されていること (内容は英語版と同じ)
1.  README.ja.md 上に存在する URL が全て有効であること
